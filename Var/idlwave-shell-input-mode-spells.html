---
title: "idlwave-shell-input-mode-spells"
layout: doc
---
<strong>idlwave-shell-input-mode-spells</strong> is a variable defined in `<code>idlw-shell.el</code>'.</br>
Its value is <pre>("^<onechar>$" "^<chars>$" "^</chars>$")</pre></br>
</br>
<strong id="documentation">Documentation:</strong></br>
The three regular expressions which match the magic spells for input modes.</br>
</br>
When the first regexp matches in the output stream of IDL, IDLWAVE</br>
prompts for a single character and sends it immediately to IDL, similar</br>
to the command M-x idlwave-shell-send-char.</br>
</br>
When the second regexp matches, IDLWAVE switches to a blocking</br>
single-character input mode.  This is the same mode which can be entered</br>
manually with M-x idlwave-shell-char-mode-loop.</br>
This input mode exits when the third regexp matches in the output,</br>
or when the IDL prompt is encountered.</br>
</br>
The variable `idlwave-shell-use-input-mode-magic' must be non-nil to enable</br>
scanning for these expressions.  If the IDL program produces lots of</br>
output, shell operation may be slowed down.</br>
</br>
This mechanism is useful for correct interaction with the IDL function</br>
GET_KBRD, because in normal operation IDLWAVE only sends \n terminated</br>
strings.  Here is some example code which makes use of the default spells.</br>
</br>
  print,'<chars>'               ; Make IDLWAVE switch to character mode</br>
  REPEAT BEGIN</br>
      A = GET_KBRD(1)</br>
      PRINT, BYTE(A)</br>
  ENDREP UNTIL A EQ 'q'</br>
  print,'</chars>'              ; Make IDLWAVE switch back to line mode</br>
</br>
  print,'Quit the program, y or n?'</br>
  print,'<onechar>'             ; Ask IDLWAVE to send one character</br>
  answer = GET_KBRD(1)</br>
</br>
Since the IDLWAVE shell defines the system variable `!IDLWAVE_VERSION',</br>
you could actually check if you are running under Emacs before printing</br>
the magic strings.  Here is a procedure which uses this.</br>
</br>
Usage:</br>
======</br>
idlwave_char_input               ; Make IDLWAVE send one character</br>
idlwave_char_input,/on           ; Start the loop to send characters</br>
idlwave_char_input,/off          ; End the loop to send characters</br>
</br>
</br>
pro idlwave_char_input,on=on,off=off</br>
  ;; Test if we are running under Emacs</br>
  defsysv,'!idlwave_version',exists=running_emacs</br>
  if running_emacs then begin</br>
      if keyword_set(on) then         print,'<chars>' $</br>
        else if keyword_set(off) then print,'</chars>' $</br>
        else                          print,'<onechar>'</br>
  endif</br>
end</br>
</br>
You can customize this variable.
